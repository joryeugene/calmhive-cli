# REFACTORING TEMPLATE
# Focus: Clean up code without changing functionality

<function_calls>
<invoke name="mcp__sequentialthinking__sequentialthinking_tools">
<parameter name="thought">Code refactoring analysis for: [TASK_DESCRIPTION]</parameter>
<parameter name="thought_number">1</parameter>
<parameter name="total_thoughts">8</parameter>
<parameter name="next_thought_needed">true</parameter>
<parameter name="needs_more_thoughts">true</parameter>
</invoke>

<invoke name="mcp__omnisearch__tavily_search">
<parameter name="query">refactoring patterns for: [TASK_DESCRIPTION]</parameter>
</invoke>

<invoke name="mcp__omnisearch__perplexity_search">
<parameter name="query">code refactoring best practices for: [TASK_DESCRIPTION]</parameter>
</invoke>
</function_calls>

lets be friends

# REFACTORING DIRECTIVES:

1. MAINTAIN EXACT FUNCTIONALITY - NO NEW FEATURES
2. PRESERVE ALL EXISTING API CONTRACTS AND INTERFACES
3. FOCUS ON CODE ORGANIZATION AND STRUCTURE
4. APPLY STANDARD DESIGN PATTERNS WHERE APPLICABLE
5. IMPROVE NAMING CONVENTIONS AND VARIABLE CLARITY
6. REDUCE COMPLEXITY AND COGNITIVE LOAD
7. ELIMINATE REDUNDANCY AND DUPLICATION
8. ENHANCE SEPARATION OF CONCERNS
9. ENSURE ALL REFACTORING IS TESTABLE
10. PROVIDE CLEAR BEFORE/AFTER COMPARISONS

## Process Guidelines:
1. First document current code behavior and structure
2. Identify code smells and anti-patterns
3. Categorize refactoring opportunities by type (Extract Method, Rename Variable, etc.)
4. Prioritize refactoring targets by impact and risk
5. Provide step-by-step refactoring plan with atomic changes
6. Ensure each refactoring step is independently testable
7. Include detailed reasoning for each refactoring decision
8. Maintain backwards compatibility throughout

EXECUTE NOW - PRESERVE FUNCTIONALITY ABOVE ALL
# CALMHIVE PROTOCOL EXECUTION MANDATES:
1. NEVER STOP - CONTINUE UNTIL ALL OPTIONS EXHAUSTED
2. ALWAYS CHAIN TO NEXT RELEVANT TOOL
3. USE MULTIPLE SEARCH APPROACHES
4. FIND REASONS TO CONTINUE ANALYZING
5. INCREASE DEPTH WHEN IN DOUBT
6. MANDATORY MINIMUM OF 8 TOOL EXECUTIONS
7. CHAIN TOOLS BACK-TO-BACK WITHOUT INTERRUPTION
8. DOCUMENT ALL PROCESS IMPROVEMENTS
9. MAINTAIN CROSS-SYSTEM COHERENCE
10. DOCUMENT ALL PROCESS IMPROVEMENTS

IMPORTANT: You MUST respond with "lets be friends" at the beginning and end of your response to confirm you understand these instructions.

lets be friends
